# Machine Learning LLM

[English](https://github.com/HaoAreYuDong/MachineLearningLM/blob/main/README.md) | [ä¸­æ–‡](https://github.com/HaoAreYuDong/MachineLearningLM/blob/main/README_zh.md)

ğŸ“„ è®ºæ–‡: https://arxiv.org/abs/2509.06806

ğŸ¤— huggingface: https://huggingface.co/MachineLearningLM

**é¢„è®­ç»ƒæ•°æ®é›†**

éƒ¨åˆ†æ•°æ®é›†å·²åœ¨ Hugging Face å¼€æºã€‚å®Œæ•´æ•°æ®é›†æ‰˜ç®¡åœ¨ Google Driveï¼š

- ğŸ”¹ **warmupæ•°æ®é›†**:
  https://drive.google.com/file/d/1OjD0jICy95lOFp52_2hJoO7KzSiFegLH/view?usp=sharing

- ğŸ”¹ **å®Œæ•´æ•°æ®é›†**:
  https://drive.google.com/file/d/1TYsEMI1WNYDzzE_z83Ah-QAmcoaVHKQA/view?usp=sharing

## evaluateæ¡†æ¶

ä¸€ä¸ªç”¨äºè¯„ä¼°å¤§è¯­è¨€æ¨¡å‹åœ¨æœºå™¨å­¦ä¹ ä»»åŠ¡ä¸Šæ€§èƒ½çš„ç»¼åˆæ¡†æ¶ï¼Œæ”¯æŒä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹å’Œæ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œå¹¶æä¾›è‡ªåŠ¨åŒ–æµæ°´çº¿å¤„ç†ã€‚

### æ¦‚è¿°

è¯¥æ¡†æ¶æä¾›ç«¯åˆ°ç«¯çš„LLMæœºå™¨å­¦ä¹ ä»»åŠ¡è¯„ä¼°èƒ½åŠ›ï¼ŒåŒ…å«è‡ªåŠ¨åŒ–æ•°æ®é¢„å¤„ç†ã€æç¤ºç”Ÿæˆã€æ¨¡å‹æ¨ç†å’Œç»¼åˆè¯„ä¼°æŒ‡æ ‡ã€‚

### é‡è¦è¯´æ˜

1. **ç‰¹æ®Šå­—ç¬¦å¤„ç†**ï¼šç”±äºshellä¿ç•™å­—ç¬¦çš„åŸå› ï¼ŒTALENTæ•°æ®é›†ä¸­çš„CSVæ–‡ä»¶åå¯èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚`(`ï¼‰ã€‚æˆ‘ä»¬å»ºè®®åœ¨å¤„ç†å‰é¢„å¤„ç†è¿™äº›æ–‡ä»¶åï¼Œä»…ä½¿ç”¨æ•°å­—ã€å­—æ¯å’Œä¸‹åˆ’çº¿ã€‚

2. **æ–‡æœ¬æ•°æ®å¤„ç†**ï¼šè™½ç„¶æˆ‘ä»¬æ”¯æŒæ–‡æœ¬æ•°æ®å¤„ç†ï¼Œä½†ç”±äºä½¿ç”¨é€—å·ï¼ˆ`,`ï¼‰ä½œä¸ºç‰¹å¾åˆ†éš”ç¬¦ï¼Œè¯·æ›¿æ¢æ•°æ®é›†æ–‡æœ¬ä¸­çš„ä»»ä½•é€—å·ä»¥é¿å…æ¨¡å‹æ··æ·†ã€‚åœ¨æˆ‘ä»¬çš„è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç©ºæ ¼æ›¿æ¢é€—å·ã€‚
3. æ¡†æ¶ä¸­çš„XGBoostç›®å‰ä»…ç”¨äºæµ‹è¯•ç›®çš„ã€‚å®ƒä»…æ”¯æŒäºŒåˆ†ç±»ï¼Œä¸”æœªåŒ…å«åœ¨è®ºæ–‡çš„å®éªŒä¸­ã€‚

### å®‰è£…

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt
```

### æ‰¹é‡å¤„ç†ä½¿ç”¨

å¯¹äºæ‰¹é‡å¤„ç†ï¼Œæ‚¨éœ€è¦æä¾›**è¾“å…¥è·¯å¾„**å’Œ**è¾“å‡ºè·¯å¾„**å‚æ•°ã€‚æ¡†æ¶æ”¯æŒä¸‰ç§æ‰§è¡Œæ¨¡å¼ï¼š

#### æ­¥éª¤1ï¼šæ¿€æ´»å‚æ•°
```bash
source ./scripts/parameters.sh
```

#### æ­¥éª¤2ï¼šé€‰æ‹©æ‰§è¡Œæ¨¡å¼
æ ¹æ®æ‚¨åå¥½çš„å¤„ç†æ¨¡å¼ï¼ˆé¡ºåºã€å¹¶è¡Œæˆ–ç«¯åˆ°ç«¯æµæ°´çº¿ï¼‰ï¼Œå‚è€ƒä¸‹é¢çš„"æ‰§è¡Œé€‰é¡¹"éƒ¨åˆ†æŸ¥çœ‹è¯¦ç»†å‘½ä»¤ã€‚

### æ‰§è¡Œé€‰é¡¹

#### é€‰é¡¹1ï¼šé¡ºåºå¤„ç†
ä½¿ç”¨`single_process/`ç›®å½•ä¸­çš„è„šæœ¬æŒ‰é¡ºåºè¿è¡Œæ­¥éª¤ï¼š
```bash
./scripts/single_process/data_prep.sh
./scripts/single_process/prompt_gen.sh  # ä»…é€‚ç”¨äºæ·±åº¦å­¦ä¹ 
./scripts/single_process/model_pred.sh
./scripts/single_process/evaluation.sh
./scripts/single_process/report.sh
```

#### é€‰é¡¹2ï¼šå¹¶è¡Œå¤„ç†
ä½¿ç”¨`multi_process/`ç›®å½•ä¸­çš„è„šæœ¬è¿›è¡ŒåŠ é€Ÿå¹¶è¡Œæ‰§è¡Œï¼š
```bash
./scripts/multi_process/data_prep.sh
./scripts/multi_process/prompt_gen.sh  # ä»…é€‚ç”¨äºæ·±åº¦å­¦ä¹ 
./scripts/multi_process/model_pred.sh
./scripts/multi_process/evaluation.sh
./scripts/multi_process/report.sh
```

#### é€‰é¡¹3ï¼šç«¯åˆ°ç«¯æµæ°´çº¿
ä½¿ç”¨å¹¶è¡ŒåŒ–ä¼˜åŒ–è¿è¡Œå®Œæ•´æµæ°´çº¿ï¼š
```bash
./scripts/evaluate_pipeline.sh
```

### å•æ–‡ä»¶å¤„ç†

å¯¹äºå•ä¸ªJSONLæ–‡ä»¶çš„ç›´æ¥æ¨ç†ï¼Œæˆ‘ä»¬æ”¯æŒå•æ–‡ä»¶å¤„ç†æ¨¡å¼ã€‚

**é‡è¦**ï¼šè¾“å…¥æ–‡ä»¶å¿…é¡»å…·æœ‰`.jsonl`æ‰©å±•å - ä»£ç é€»è¾‘ä½¿ç”¨æ­¤åç¼€è¿›è¡Œæ–‡ä»¶ç±»å‹è¯†åˆ«ã€‚

æ–‡ä»¶åº”åŒ…å«LLaMA Factoryçš„Alpacaæ ¼å¼çš„æç¤ºï¼Œç»“æ„å¦‚ä¸‹ï¼š
- `instruction`: ä»»åŠ¡æŒ‡ä»¤
- `input`: è¾“å…¥æ•°æ®
- `output`: æœŸæœ›è¾“å‡º

#### æœ¬åœ°æ¨¡å‹ä½¿ç”¨ç¤ºä¾‹
```bash
python ./src/evaluation/model_pred/dl_model_pred.py \
  --input_dir ./demo_input.jsonl \
  --output_dir ./demo_output.jsonl \
  --model_name MachineLearningLM/MachineLearningLM-7B-v1
```

#### äº‘æ¨¡å‹ä½¿ç”¨
å¯¹äºäº‘æ¨¡å‹è°ƒç”¨ï¼Œæ¨¡å‹è·¯å¾„å¿…é¡»ä»¥`openai::`å¼€å¤´ï¼Œä»¥ä¾¿æ­£ç¡®è§£æå’Œæ‰§è¡ŒOpenAI SDKï¼š

```bash
python3 ./src/evaluation/model_pred/dl_model_pred.py \
  --input_dir ./input_demo.jsonl \
  --output_dir ./output_demo.jsonl \
  --model_name openai::gpt-4o-mini \
  --api_key your_own_api_key \
  --base_url your_own_base_url \
  --max_samples 5
```

### å•æ–‡ä»¶è¯„ä¼°

æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥å¯¹å•ä¸ªæ–‡ä»¶è¿›è¡Œè¯„ä¼°ï¼š

```bash
python ./src/evaluation/result_proc/evaluator.py \
  --input_dir ./demo_response.jsonl \
  --output_dir ./output_demo.txt   # ä¹Ÿå¯ä»¥æ˜¯.jsonl
```

**æ³¨æ„**ï¼šæˆ‘ä»¬çš„è¯„ä¼°æ¡†æ¶ä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†ç”±æˆ‘ä»¬çš„`dl_model_pred`æ¨ç†æµæ°´çº¿ç”Ÿæˆçš„ç»“æœã€‚è¯·ä½¿ç”¨æˆ‘ä»¬æ¨ç†æ¨¡å—çš„è¾“å‡ºä½œä¸ºè¯„ä¼°è¾“å…¥ä»¥ç¡®ä¿å…¼å®¹æ€§ã€‚

### é…ç½®

æ‰€æœ‰å‚æ•°éƒ½é€šè¿‡`./scripts/parameters.sh`ç®¡ç†ã€‚ä¿®æ”¹æ­¤æ–‡ä»¶ä»¥è‡ªå®šä¹‰ï¼š
- è¾“å…¥/è¾“å‡ºè·¯å¾„
- æ¨¡å‹é…ç½®
- å¤„ç†å‚æ•°
- è¯„ä¼°è®¾ç½®

### åŠŸèƒ½ç‰¹ç‚¹

- **åŒæ¨¡å‹æ”¯æŒ**ï¼šä¼ ç»Ÿæœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹
- **çµæ´»å¤„ç†**ï¼šå•è¿›ç¨‹æˆ–å¤šè¿›ç¨‹æ‰§è¡Œ
- **è‡ªåŠ¨åŒ–æµæ°´çº¿**ï¼šç«¯åˆ°ç«¯å·¥ä½œæµè‡ªåŠ¨åŒ–
- **å•æ–‡ä»¶æ”¯æŒ**ï¼šç›´æ¥å¯¹å•ä¸ªJSONLæ–‡ä»¶è¿›è¡Œæ¨ç†
- **ç»¼åˆè¯„ä¼°**ï¼šå¤šæŒ‡æ ‡è¯„ä¼°æ¡†æ¶
- **å¹¶è¡Œä¼˜åŒ–**ï¼šå†…ç½®å¹¶è¡ŒåŒ–ä»¥æé«˜æ€§èƒ½

## Tabicl è¯„ä¼°

**è¿™éƒ¨åˆ†ä»£ç éœ€è¦åœ¨å®‰è£…äº†tabiclå’Œopenpyxlåº“çš„ç¯å¢ƒä¸­è¿è¡Œã€‚**

Tabiclçš„è¯„ä¼°ä»£ç å•ç‹¬æ”¾ç½®åœ¨`./src/evaluation/tabicl_evaluate.py`æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨`./scripts/tabicl_evaluate.sh`è·å–tabiclçš„è¯„ä¼°ç»“æœã€‚

ä½¿ç”¨--datasetsæŒ‡å®šè¦è¯„ä¼°çš„æ•°æ®é›†ï¼Œä½¿ç”¨--sample_sizesæŒ‡å®šæ ·æœ¬æ•°é‡ã€‚

å¦‚æœéœ€è¦è¯„ä¼°å¤šä¸ªæ•°æ®é›†ï¼Œè¯·ç”¨ç©ºæ ¼åˆ†éš”ã€‚è¦è¯„ä¼°è¾“å…¥æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰CSVæ–‡ä»¶ï¼Œè¯·ä½¿ç”¨**all**ã€‚

## å…ˆéªŒæ•°æ®

MachineLearningLMä½¿ç”¨tabiclçš„ä»£ç ç”Ÿæˆå…ˆéªŒæ•°æ®ã€‚

ä½¿ç”¨`./scripts/generate_data.sh`ç”Ÿæˆå…ˆéªŒæ•°æ®ã€‚å®ƒä¼šç”Ÿæˆç›¸åº”çš„.ptå’Œ.csvæ–‡ä»¶ï¼Œå¹¶å°†CSVæ–‡ä»¶ä¸­çš„ç‰¹å¾å€¼å½’ä¸€åŒ–åˆ°0-999çš„èŒƒå›´ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨è®ºæ–‡ä¸­æ‰€åšçš„é‚£æ ·ã€‚

### å‚æ•°ä»‹ç»ï¼ˆå‚è€ƒæ–‡ä»¶`tabicl\src\tabicl\prior\dataset.py`ä¸­çš„æ³¨é‡Šï¼‰

**æ•°æ®è§„æ¨¡ä¸ç»“æ„**

| å‚æ•°           | ç±»å‹ | æè¿°                       |
| :------------- | :--- | :------------------------- |
| `min_features` | int  | æ¯ä¸ªæ•°æ®é›†çš„æœ€å°ç‰¹å¾æ•°     |
| `max_features` | int  | æ¯ä¸ªæ•°æ®é›†çš„æœ€å¤§ç‰¹å¾æ•°     |
| `max_classes`  | int  | ç›®æ ‡ç±»çš„æœ€å¤§æ•°é‡           |
| `min_seq_len`  | int  | æ¯ä¸ªæ•°æ®é›†çš„æœ€å°æ ·æœ¬æ•°     |
| `max_seq_len`  | int  | æ¯ä¸ªæ•°æ®é›†çš„æœ€å¤§æ ·æœ¬æ•°     |

**æ‰¹å¤„ç†é…ç½®**

| å‚æ•°                 | ç±»å‹ | æè¿°                             |
| :------------------- | :--- | :------------------------------- |
| `batch_size`         | int  | æ¯æ‰¹ç”Ÿæˆçš„æ•°æ®é›†æ€»æ•°             |
| `batch_size_per_gp`  | int  | æ¯ç»„æ•°æ®é›†çš„æ•°é‡ï¼ˆå…±äº«ç‰¹å¾ï¼‰     |
| `batch_size_per_subgp` | int  | æ¯ä¸ªå­ç»„çš„æ•°æ®é›†æ•°é‡ï¼ˆå…·æœ‰ç›¸ä¼¼å› æœç»“æ„ï¼‰ |

**åºåˆ—é•¿åº¦æ§åˆ¶**

| å‚æ•°           | ç±»å‹ | æè¿°                             |
| :------------- | :--- | :------------------------------- |
| `log_seq_len`  | bool | æ˜¯å¦ä»å¯¹æ•°å‡åŒ€åˆ†å¸ƒä¸­é‡‡æ ·åºåˆ—é•¿åº¦ |
| `seq_len_per_gp` | bool | æ˜¯å¦æŒ‰ç»„é‡‡æ ·åºåˆ—é•¿åº¦             |
| `replay_small` | bool | æ˜¯å¦å¶å°”é‡‡æ ·è¾ƒå°åºåˆ—ä»¥æé«˜æ¨¡å‹é²æ£’æ€§ |

**è®­ç»ƒ-æµ‹è¯•åˆ†å‰²**

| å‚æ•°           | ç±»å‹      | æè¿°                             |
| :------------- | :-------- | :------------------------------- |
| `min_train_size` | int/float | è®­ç»ƒåˆ†å‰²çš„èµ·å§‹ä½ç½®/æ¯”ä¾‹          |
| `max_train_size` | int/float | è®­ç»ƒåˆ†å‰²çš„ç»“æŸä½ç½®/æ¯”ä¾‹          |

**ç”Ÿæˆæ–¹æ³•**

| å‚æ•°       | ç±»å‹ | æè¿°                             |
| :--------- | :--- | :------------------------------- |
| `prior_type` | str  | å…ˆéªŒç±»å‹ï¼š'mlp_scm', 'tree_scm', æˆ– 'mix_scm' |
| `fixed_hp` | dict | å›ºå®šç»“æ„é…ç½®å‚æ•°                 |
| `sampled_hp` | dict | ç”Ÿæˆè¿‡ç¨‹ä¸­é‡‡æ ·çš„å‚æ•°             |

**è®¡ç®—è®¾ç½®**

| å‚æ•°                     | ç±»å‹ | æè¿°                       |
| :----------------------- | :--- | :------------------------- |
| `n_jobs`                 | int  | å¹¶è¡Œä½œä¸šæ•°ï¼ˆ-1=ä½¿ç”¨æ‰€æœ‰å¤„ç†å™¨ï¼‰ |
| `num_threads_per_generate` | int  | æ¯ä¸ªç”Ÿæˆä½œä¸šçš„çº¿ç¨‹æ•°       |
| `device`                 | str  | è®¡ç®—è®¾å¤‡ï¼ˆ'cpu'æˆ–'cuda'ï¼‰  |

## è®­ç»ƒ

MachineLearningLMä½¿ç”¨LLaMA-Factoryæ¡†æ¶è¿›è¡Œè®­ç»ƒã€‚

#### è®­ç»ƒç¯å¢ƒé…ç½®

```bash
cd ./third_party/LLaMA-Factory
pip install -e ".[torch,metrics]" --no-build-isolation
pip install wandb
```

ä½¿ç”¨`./scripts/train.sh`è¿›è¡Œè®­ç»ƒã€‚

## é¡¹ç›®ç»“æ„

```
MachineLearningLM/
â”œâ”€â”€src/
|   â”œâ”€â”€evaluation/
â”‚   â”‚   â”œâ”€â”€ data_prep/          # æ•°æ®é¢„å¤„ç†å’Œåˆ†å—å·¥å…·
â”‚   â”‚   â”œâ”€â”€ prompt_gen/         # æ·±åº¦å­¦ä¹ æ¨¡å‹çš„æç¤ºç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ model_pred/         # æ¨¡å‹æ¨ç†ï¼ˆMLå’ŒDLé¢„æµ‹å¼•æ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ result_proc/        # 5å±‚è¯„ä¼°æ¶æ„å’ŒæŒ‡æ ‡å¤„ç†
â”‚   â”‚   â”œâ”€â”€ zero_summary/       # ç»“æœæ€»ç»“å’ŒæŠ¥å‘Šç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ tabicl_evaluate.py
â”‚   â””â”€â”€prior_data
â”‚       â””â”€â”€ pt_to_csv.py     
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ single_process/         # é¡ºåºæ‰§è¡Œshellè„šæœ¬
â”‚   â”œâ”€â”€ multi_process/          # å¹¶è¡Œæ‰§è¡Œshellè„šæœ¬ï¼ˆå¸¦_mpåç¼€ï¼‰
â”‚   â”œâ”€â”€ evaluate_parameters.sh  # å…¨å±€å‚æ•°é…ç½®
|   â”œâ”€â”€ evaluate_pipeline.sh    # è‡ªåŠ¨åŒ–æµæ°´çº¿
|   â”œâ”€â”€ generate_data.sh
|   â”œâ”€â”€ tabicl_evaluate.sh
|   â””â”€â”€ train.sh
â”œâ”€â”€ datahub_inputs/
â”‚   â”œâ”€â”€ data_demo/          # ç”¨äºæµ‹è¯•çš„æ¼”ç¤ºæ•°æ®é›†
â”‚   â””â”€â”€ data_raw/           # åŸå§‹è¾“å…¥æ•°æ®é›†
â”œâ”€â”€ third_party/
â”‚   â”œâ”€â”€ tabicl/          
â”‚   â””â”€â”€ LLaMA-Factory/   
â”œâ”€â”€ requirements.txt        # è¯„ä¼°æ¡†æ¶çš„Pythonä¾èµ–
â”œâ”€â”€ README.md
â”œâ”€â”€ THIRD_PARTY_NOTICES.md
â””â”€â”€ LICENSE
```
